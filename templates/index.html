
{% include 'base.html' %}
{% load tags %}
<div class="bxslider"  >
    {% for img in list_img %}
        <a href="{{ img.href }}"><img src="{{ img.img }}" style="width: 100%;height:400px"></a>
    {% endfor %}
</div>
<div style="width: 100%;height: 200px;">
    <h1 style="font-size: 18px;margin-left: 200px">最新公告</h1>
    <ul style="width: 100%;margin-left: 150px">
        {% for notice in list_notice %}
            <div style="float: left;width:240px;height: 60px;margin: 0 28px 0 28px">
                <i class="fa fa-bell fa-2x" aria-hidden="true" style="margin-left: -15px"></i>
                <h4 style="display: inline-block">{{ notice.name }}</h4>
{#                <div style="margin-left: 28px;float: left;">#}
                <div class="notice">
                    <div >{% get_date notice %}</div>
                </div>

{#                    <h6>......</h6>#}
{#                    <a class="get" name="{{ notice.id }}">查看更多</a>#}
{#                </div>#}
{#            <input type="">#}
            </div>
        {% endfor %}
    </ul>


</div>
{#<div style="width: 100%;height: 200px;">#}
     <h1 style="font-size: 18px;margin-left: 200px">资源介绍</h1>



    <div id="container" class="w">
        <div class="item">
        </div>
        <div class="item">
        </div>
        <div class="item">
        </div>
        <div class="item">
        </div>
{#        <div class="item">#}
{#        </div>#}
    </div>

</div>
<script src="/static/jquery-3.1.1.js"></script>
<script src="/static/bxslider-4-4.2.12/src/js/jquery.bxslider.js"></script>
<script>
    function my() {
        alert(1)
    }
    {#$("#gg").text()#}
    {#y=document.getElementById("#gg")#}
    {#alert(x)#}
    {#console.log($(".date").text())#}
    $('.bxslider').bxSlider({
        auto: true,
        autoControls: true,
        stopAutoOnClick: true,
        pager: true,
        slideWidth: 470,

    });

      $("[name=1]").click(function () {
       {#nid=$("[name=1]").attr('name')#}
       {#     console.log(nid)#}
          nid=1
          $.ajax({
           url:"/get_notice.html",
           type:"GET",
           data:{nid:nid},
           dataType: 'JSON',
           success:function (arg) {
               console.log(arg.data[0].id)
             $("[class=1]").text(arg.data[0].data1)
               $("[name=1]").text('')

           }

       })


   })

      $("[name=2]").click(function () {
       {#nid=$("[name=1]").attr('name')#}
       {#     console.log(nid)#}
          nid=2
          $.ajax({
           url:"/get_notice.html",
           type:"GET",
           data:{nid:nid},
           dataType: 'JSON',
           success:function (arg) {
               console.log(arg.data[0].id)
             $("[class=2]").text(arg.data[0].data1)
               $("[name=2]").text('')

           }

       })


   })
          $("[name=3]").click(function () {
       {#nid=$("[name=1]").attr('name')#}
       {#     console.log(nid)#}
          nid=3
          $.ajax({
           url:"/get_notice.html",
           type:"GET",
           data:{nid:nid},
           dataType: 'JSON',
           success:function (arg) {
               console.log(arg.data[0].id)
             $("[class=3]").text(arg.data[0].data1)
               $("[name=3]").text('')

           }

       })


   })


    $(function () {
        var obj = new ScrollImg();
        obj.fetchImg();
        obj.scrollEvent();

    });
    function ScrollImg() {
        this.NID = 0;
        this.LASTPOSITION = 3;
        this.fetchImg = function () {
            var that = this;
            $.ajax({
                url: '/get_img.html',
                type: 'GET',
                data: {nid: that.NID},
                dataType: 'JSON',
                success: function (arg) {
                    var img_list = arg.data;
                    $.each(img_list, function (index, v) {
                        var eqv = (index + that.LASTPOSITION + 1) % 4;
                        {#console.log(eqv);#}
                        var tag = document.createElement('img');
                        tag.src = '/' + v.img;
                        $('#container').children().eq(eqv).append(tag);
                        if (index + 1 == img_list.length) {
                            that.LASTPOSITION = eqv;
                            {#that.NID = v.id;#}
                    }
                })
            }
        })
    }


         this.scrollEvent = function () {
            var that = this;
            $(window).scroll(function () {
                var scrollTop = $(window).scrollTop();
                var winHeight = $(window).height();
                var docHeight = $(document).height();
                if (scrollTop + winHeight == docHeight) {
                    that.fetchImg();
        }
        })
        }


    }


    {#var obj = new scrollImg()#}
    {#obj.initImg()#}
    {#obj.scrollEvent()#}
    {#nid=0#}
    {#LASTPOSITION=4#}
    {#function initImg() {#}
    {#    $.ajax({#}
    {#        url:'/get_img.html',#}
    {#        type:'GET',#}
    {#        data:{'nid':nid},#}
    {#        dataType:'JSON',#}
    {#        success:function (arg) {#}
    {#            var img_list = arg.data#}
    {#            $.each(img_list,function (k,v) {#}
    {#                var eqv = (k+LASTPOSITION+1)%5;#}
    {#                console.log(eqv)#}
    {#                var tag = document.createElement('img')#}
    {#                tag.src = '/'+v.img#}
    {#                $('#imgs').children().eq(eqv).append(tag)#}
    {#                if(k+1 == img_list.length){#}
    {#                    LASTPOSITION=eqv#}
    {#                }#}
    {#            })#}
    {#        }#}
    {#    })#}

    {#function scrollEvent() {#}
    {#    $(window).scroll(function () {#}
    {#            var win_height=$(window).height();#}
    {#            var doc_height=$(document).height();#}
    {#            var scr_height=$(window).scrollTop();#}
    {#            if(win_height+scr_height == doc_height){#}
    {#                initImg()#}
    {#    }#}
    {#    })#}
    {##}


</script>

